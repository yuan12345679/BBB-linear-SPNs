
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{mathrsfs}
\usepackage{extarrows}

\usepackage{algorithm}
\usepackage{algpseudocode}

\usepackage{float}
\usepackage{xspace}
\usepackage[inline]{enumitem}

%\usepackage{ulem}


%\def\proof{\IEEEproof}\def\endproof{\endIEEEproof}


\newcommand{\chun}[1]{{\color{red} [Chun: #1]}}




\newcommand\arrangespace{\vspace{+0.7em}}
\newcommand\reducespace{\vspace{-1.5mm}}
\newcommand\reducelittlespace{\vspace{-0.3mm}}
\newcommand\codeindent{\ \ }
\newcommand\tosinglespace{\vspace{-1mm}}





\newcommand\revision{\textcolor{red}}
\newcommand\markblue{\textcolor{blue}}
\newcommand\markgreen{\textcolor{green}}





\newcommand\advantage{\mathbf{Adv}\xspace}	% sum of hash-then-mac




\newcommand\htm{\textsf{HtM}\xspace}	% plain hash-then-mac

\newcommand\shm{\textsf{SHM}\xspace}	% sum of hash-then-mac
\newcommand\eshm{\textsf{ESHM}\xspace}	% encrypted sum of hash-then-mac
\newcommand\chm{\textsf{ConHM}\xspace}	% concatenated hash-then-mac
\newcommand\epshm{\textsf{LRWHM}\xspace}	% encrypted partial sum of hash-then-mac
\newcommand\rhm{\textsf{RHM}\xspace}	% rekeying-based hash-then-mac
\newcommand\prshm{\textsf{PrSHM}}	
\newcommand\ashm{\textsf{ASHM}}	% AXU-based sum of hash-then-mac
\newcommand\aes{\ensuremath{\mathsf{AES}}\xspace}
\newcommand\sha{\ensuremath{\mathsf{SHA-3}}\xspace}
\newcommand\keccackf{{\ensuremath{\textsc{Keccak-}f}}\xspace}


% The two main leakage MAC security notions
\newcommand\macla{\textsf{MAL1}\xspace}
\newcommand\maclb{\textsf{MAL2}\xspace}
%\newcommand\maclb{\textsf{MAL}\xspace}

\newcommand\collr{\textsf{CR}\xspace}
\newcommand\scr{\textsf{SCR}\xspace}
\newcommand\lspr{\text{LSPR}\xspace}
\newcommand\rspr{\text{RSPR}\xspace}
\newcommand\sprp{\textsf{SPRP}\xspace}
%\newcommand\scr{\text{SCR}}



\newcommand\hmac{\textsf{Scheme}\xspace}
\newcommand\mac{\textsf{TGen}\xspace}
\newcommand\macl{\textsf{LTGen}\xspace}
\newcommand\vrfy{\textsf{Vrfy}\xspace}
\newcommand\vrfyl{\textsf{LVrfy}\xspace}
\newcommand\kgen{\textsf{KeyGen}\xspace}
\newcommand\filmac{\textsf{FILTG}\xspace}

\newcommand\feai{\text{(F-1)}\xspace}
\newcommand\feaii{\text{(F-2)}\xspace}
\newcommand\feaiii{\text{(F-3)}\xspace}
\newcommand\feaiv{\text{(F-4)}\xspace}
\newcommand\feav{\text{(F-5)}\xspace}
\newcommand\feavi{\text{(F-6)}\xspace}
\newcommand\feavii{\text{(F-7)}\xspace}
\newcommand\feaviii{\text{(F-8)}\xspace}
\newcommand\feaviiii{\text{(F-9)}\xspace}
\newcommand\eone{\text{(E-1)}\xspace}
\newcommand\etwo{\text{(E-2)}\xspace}
\newcommand\ethree{\text{(E-3)}\xspace}
\newcommand\efour{\text{(E-4)}\xspace}
\newcommand\efive{\text{(E-5)}\xspace}
\newcommand\esix{\text{(E-6)}\xspace}
\newcommand\eseven{\text{(E-7)}\xspace}
\newcommand\eeight{\text{(E-8)}\xspace}
\newcommand\hone{\text{(H-1)}\xspace}
\newcommand\htwo{\text{(H-2)}\xspace}
\newcommand\hthree{\text{(H-3)}\xspace}
\newcommand\hfour{\text{(H-4)}\xspace}
\newcommand\hfive{\text{(H-5)}\xspace}
\newcommand\hsix{\text{(H-6)}\xspace}
\newcommand\hseven{\text{(H-7)}\xspace}
\newcommand\height{\text{(H-8)}\xspace}
\newcommand\hnine{\text{(H-9)}\xspace}
\newcommand\bone{\text{(B-1)}\xspace}
\newcommand\btwo{\text{(B-2)}\xspace}
\newcommand\bthree{\text{(B-3)}\xspace}
\newcommand\bfour{\text{(B-4)}\xspace}
\newcommand\bfive{\text{(B-5)}\xspace}
\newcommand\bsix{\text{(B-6)}\xspace}
\newcommand\bseven{\text{(B-7)}\xspace}
\newcommand\cone{\text{(C-1)}\xspace}
\newcommand\ctwo{\text{(C-2)}\xspace}
\newcommand\cthree{\text{(C-3)}\xspace}
\newcommand\cfour{\text{(C-4)}\xspace}
\newcommand\cfive{\text{(C-5)}\xspace}
\newcommand\csix{\text{(C-6)}\xspace}
\newcommand\cseven{\text{(C-7)}\xspace}
\newcommand\ceight{\text{(C-8)}\xspace}
\newcommand\cnine{\text{(C-9)}\xspace}
\newcommand\ci{\text{(C-i)}\xspace}
\newcommand\hi{\text{(H-i)}\xspace}

%\newcommand\roqueries{\ensuremath{ROSet}\xspace}
%\newcommand\pqueries{\ensuremath{PSet}\xspace}
%\newcommand\icqueries{\ensuremath{ICSet}\xspace}
%\newcommand\mset{\ensuremath{TGened}\xspace}
\newcommand\roqueries{\ensuremath{\mbox{ROSet}}\xspace}
\newcommand\qnum{\ensuremath{\mbox{qnum}}\xspace}
\newcommand\pqueries{\ensuremath{\mbox{PSet}}\xspace}
\newcommand\icqueries{\ensuremath{\mbox{ICSet}}\xspace}
\newcommand\mset{\ensuremath{\mbox{TGened}}\xspace}
\newcommand\sfp{\ensuremath{\mathsf{P}}\xspace}



\newcommand\chain{\textsf{Chain}\xspace}




\newcommand\sample{\xleftarrow{\$}}


\newcommand\mprpbound{q_v\varepsilon_{\textsf{E}}}


\newcommand\lf{\textsf{L}}
\newcommand\s{\mathcal{S}}
\newcommand\adv{\ensuremath{\mathcal{A}}\xspace}
\newcommand\e{\textsf{E}\xspace}
\newcommand\h{\textsf{H}\xspace}
\newcommand\ro{\textsf{RO}\xspace}
\newcommand\ic{\textsf{IC}\xspace}
\newcommand\ah{\mathcal{AH}}
\newcommand\g{\textsf{G}}
\newcommand\oracle{\textsf{O}\xspace}
\newcommand\oracleset{\mathcal{O}\xspace}
\newcommand\msgspace{\ensuremath{\mathcal{M}}\xspace}
\newcommand\kspace{\ensuremath{\mathcal{K}}\xspace}
\newcommand\bft{\ensuremath{\mathbf{t}}\xspace}
\newcommand\con{\ensuremath{\texttt{CON}}\xspace}



\newcommand\is{\mathbf{IS}}
\newcommand\keccakpfour{\ensuremath{\textsc{Keccak-}f[400]}\xspace}
\newcommand\isapmac{\ensuremath{\textsc{IsapMac}}\xspace}
\newcommand\isapmacK{\ensuremath{\textsc{IsapMacK}}\xspace}
\newcommand\isapmacKA{\ensuremath{\textsc{IsapMacKA}}\xspace}

%\newcommand\p{\mathbf{P}}
\newcommand\p{P}



%\newcommand\Adv{\mathbf{Adv}}


\newcommand\D{\Delta}
\newcommand\Zn{\{0,1\}^n}
\newcommand\xor{\oplus}
\newcommand\mul{\otimes}
\newcommand\ga{\gamma}




\newcommand\roset{\mathcal{H}(2n)\xspace}
\newcommand\functionset{\mathcal{F}(n)\xspace}
\newcommand\permutationset{\mathcal{P}(n)\xspace}
\newcommand\blockcipherset{\mathcal{BC}(n,n)\xspace}

%\newcommand\pvector{\ensuremath{\mathbf{P}}\xspace}
%\newcommand\pvector{\ensuremath{\overrightarrow{\mathsf{P}}}\xspace}
\newcommand\pvector{\ensuremath{\mathsf{P}}\xspace}
\newcommand\kvector{\ensuremath{\overrightarrow{K}}\xspace}



\newcommand\datacomplexity{\ensuremath{\text{Data}}\xspace}
\newcommand\timecomplexity{\ensuremath{\text{Time}}\xspace}
%



\newcommand\arrangelongline{\noindent\rule{13.5cm}{0.4pt}}


